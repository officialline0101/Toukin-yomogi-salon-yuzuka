<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;600&family=Zen+Maru+Gothic:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <style>
        /* =========================================
           ã‚«ãƒ©ãƒ¼ãƒ»å¤‰æ•°å®šç¾©
           ========================================= */
        :root {
            --primary-green: #6e8276;
            --accent-yellow: #f0e28a;
            --bg-color: #f6f5f1;
            --text-main: #4a4a4a;
            --text-white: #ffffff;
            --input-bg: #ffffff;
            --shadow-soft: 0 4px 20px rgba(110, 130, 118, 0.15);
            --radius-main: 8px;
        }

        /* =========================================
           åŸºæœ¬ãƒªã‚»ãƒƒãƒˆ & ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
           ========================================= */
        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px 10px;
            line-height: 1.6;
        }

        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: var(--shadow-soft);
            width: 100%;
            max-width: 600px;
            padding: 40px 30px;
            box-sizing: border-box;
            margin: 0 auto;
            position: relative;
            border: 1px solid #fff;
        }

        /* =========================================
           ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒ³
           ========================================= */
        h1 {
            font-family: 'Shippori Mincho', serif;
            color: var(--primary-green);
            text-align: center;
            font-size: 28px;
            font-weight: 600;
            margin: 0 0 40px 0;
            position: relative;
            padding-bottom: 15px;
            letter-spacing: 0.1em;
        }

        h1::after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background-color: var(--accent-yellow);
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }

        h1 .small-text {
            font-family: 'Zen Maru Gothic', sans-serif;
            font-size: 14px;
            color: #8a9a90;
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            letter-spacing: 0.05em;
        }

        /* =========================================
           ãƒ©ãƒ™ãƒ« & ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 
           ========================================= */
        .label, .labelkibounitizi, .labeltyuuou, .labelmessezi {
            font-family: 'Shippori Mincho', serif;
            font-size: 18px;
            color: var(--primary-green);
            margin: 25px 0 10px 0;
            padding-left: 10px;
            border-left: 4px solid var(--accent-yellow);
            background: none;
            border-top: none;
            border-bottom: none;
            text-align: left;
            font-weight: 600;
        }

        .required {
            background-color: #d97d7d;
            color: #fff;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 10px;
            vertical-align: middle;
            font-family: sans-serif;
            letter-spacing: 0;
        }

        input[type="text"], input[type="tel"], textarea, select {
            width: 100%;
            padding: 14px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: var(--radius-main);
            background-color: #fafafa;
            font-size: 16px;
            box-sizing: border-box;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus {
            background-color: #fff;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(110, 130, 118, 0.2);
            outline: none;
        }

        input::placeholder, textarea::placeholder {
            color: #ccc;
        }

        /* =========================================
           ãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆæ¥åº—å›æ•°ãƒ»ãƒ¡ãƒ‹ãƒ¥ãƒ¼å…±é€šï¼‰
           ========================================= */
        .visit-buttons, .menu-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
        }

        .visit-buttons button, .menu-buttons button {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 30px;
            background-color: #fff;
            color: var(--text-main);
            cursor: pointer;
            font-size: 15px;
            transition: all 0.2s ease;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.03);
            font-family: 'Zen Maru Gothic', sans-serif;
        }

        .visit-buttons button:hover, .menu-buttons button:hover {
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .visit-buttons button.active, .menu-buttons button.active {
            background-color: var(--primary-green);
            color: #fff;
            border-color: var(--primary-green);
            box-shadow: 0 4px 10px rgba(110, 130, 118, 0.4);
            transform: translateY(-1px);
        }

        /* æ¥åº—å›æ•°ã¯æ¨ªä¸¦ã³ */
        .visit-buttons {
            flex-wrap: wrap;
        }
        .visit-buttons button {
            flex: 1 1 30%;
        }
        @media (max-width: 480px) {
            .visit-buttons button {
                flex: 1 1 45%;
            }
        }

        /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ã¯ç¸¦ä¸€åˆ— */
        .menu-buttons {
            flex-direction: column; 
            gap: 10px; 
        }
        .menu-buttons button {
            width: 100%; 
            text-align: left; 
            padding-left: 20px; 
            position: relative;
        }
        
        .menu-buttons button::after {
            content: '\f105';
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #ddd;
            transition: color 0.2s;
        }
        .menu-buttons button.active::after {
            color: #fff; 
        }

        /* =========================================
           ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼‰
           ========================================= */
        .category-toggle {
            width: 100%;
            background-color: var(--primary-green);
            color: #fff;
            padding: 20px;
            text-align: center;
            border: none;
            outline: none;
            cursor: pointer;
            font-size: 18px;
            font-family: 'Shippori Mincho', serif;
            letter-spacing: 0.1em;
            margin-top: 20px;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .category-toggle::before {
            content: '\f4d8';
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%) rotate(45deg);
            font-size: 60px;
            color: rgba(255, 255, 255, 0.15);
        }

        .category-toggle::after {
            content: '\f4d8';
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%) rotate(-45deg) scaleX(-1);
            font-size: 60px;
            color: rgba(255, 255, 255, 0.15);
        }
        
        .category-toggle span {
            position: relative;
            z-index: 2;
        }
        
        .category-toggle i {
            margin-left: 15px;
            font-size: 0.8em;
            position: relative;
            z-index: 2;
        }

        .category-toggle:hover {
            background-color: #5d7065;
            transform: translateY(-2px);
        }

        .category-toggle.has-selection {
            background-color: #fff;
            color: var(--primary-green);
            border: 2px solid var(--primary-green);
        }
        .category-toggle.has-selection::before,
        .category-toggle.has-selection::after {
            color: rgba(110, 130, 118, 0.1);
        }
        
        .category-toggle.has-selection i {
             color: var(--primary-green);
        }

        .selection-badge {
            display: none;
            font-size: 12px;
            background-color: var(--accent-yellow);
            color: #555;
            padding: 2px 8px;
            border-radius: 20px;
            margin-left: 10px;
            vertical-align: middle;
            font-weight: bold;
            font-family: sans-serif;
        }
        .category-toggle.has-selection .selection-badge {
            display: inline-block;
        }

        .category-content {
            display: none;
            padding: 20px;
            border: 2px solid var(--primary-green);
            border-top: none;
            background: #fff;
            border-radius: 0 0 8px 8px;
            margin-top: -5px;
            position: relative;
            z-index: 1;
        }

        .sub-label {
            color: var(--primary-green);
            border-bottom: 1px dashed var(--primary-green);
            margin: 15px 0 15px 0;
            font-weight: 600;
            display: block;
            padding-bottom: 5px;
        }

        /* =========================================
           æ—¥æ™‚é¸æŠ
           ========================================= */
        .datetime-wrapper {
            margin-bottom: 25px;
            background: #fafafa;
            padding: 15px;
            border-radius: 8px;
            border: 1px dashed #ddd;
        }
        .dt-grid {
            display: flex;
            gap: 15px;
        }
        .placeholder {
            display: block;
            text-align: center;
            font-size: 12px;
            color: var(--primary-green);
            margin-bottom: 8px;
            font-weight: bold;
        }

        /* =========================================
           ç¢ºèªã‚¨ãƒªã‚¢ & é€ä¿¡ãƒœã‚¿ãƒ³
           ========================================= */
        #displayInfo {
            background: #fff;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #eee;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            font-size: 15px;
            line-height: 1.8;
            margin-top: 20px;
            position: relative;
        }
        #displayInfo::before {
            content: "";
            position: absolute;
            top: -5px;
            left: 5px;
            right: 5px;
            height: 5px;
            background-image: linear-gradient(135deg, #eee 25%, transparent 25%), linear-gradient(225deg, #eee 25%, transparent 25%);
            background-size: 10px 10px;
        }

        .info-row {
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .info-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .info-label {
            color: var(--primary-green);
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            display: block;
        }
        .info-row strong {
            color: #d97d7d;
        }

        .edit-button {
            float: right;
            background: #fff;
            border: 1px solid #ccc;
            color: #777;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .edit-button:hover {
            background: #eee;
            color: #333;
        }

        .submit-button {
            width: 100%;
            padding: 20px;
            font-size: 20px;
            font-weight: bold;
            background-color: var(--primary-green);
            color: #fff;
            border: none;
            border-radius: 50px;
            margin-top: 40px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(110, 130, 118, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
            font-family: 'Shippori Mincho', serif;
            letter-spacing: 0.1em;
        }
        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(110, 130, 118, 0.5);
            background-color: #5d7065;
        }
        .submit-button::after {
            content: '\f1d8';
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            margin-left: 10px;
        }

        /* ãƒœã‚¿ãƒ³ç„¡åŠ¹åŒ–æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .submit-button:disabled {
            background-color: #ccc;
            color: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .submit-button:disabled::after {
            display: none; /* ã‚¢ã‚¤ã‚³ãƒ³ã‚’æ¶ˆã™ */
        }

    </style>
</head>

<body>

    <div class="container">
        <h1>
            <span class="small-text">æ±é‡‘ã‚ˆã‚‚ãè’¸ã—ã‚µãƒ­ãƒ³ ã€œæŸšé¦™ã€œ</span>
            äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ 
        </h1>

        <div class="label" id="lbl_name">ãŠå®¢æ§˜å<span class="required">å¿…é ˆ</span></div>
        <input type="text" id="name" placeholder="ä¾‹ï¼šæŸšé¦™ èŠ±å­" oninput="saveInput('name'); updateDisplayInfo()">

        <div class="label" id="lbl_phone">é›»è©±ç•ªå·<span class="required">å¿…é ˆ</span></div>
        <input type="tel" id="phone" placeholder="ä¾‹ï¼š090-1234-5678" oninput="saveInput('phone'); updateDisplayInfo()">

        <div class="label" id="lbl_visit">ã”æ¥åº—å›æ•°<span class="required">å¿…é ˆ</span></div>
        <div class="visit-buttons">
            <button type="button" onclick="selectVisit(this)">æ–°è¦</button>
            <button type="button" onclick="selectVisit(this)">ãƒªãƒ”ãƒ¼ã‚¿ãƒ¼</button>
            <button type="button" onclick="selectVisit(this)">ãƒ¡ãƒ³ãƒãƒ¼ä¼šå“¡</button>
        </div>

        <div class="label" id="lbl_menu">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãŠé¸ã³ãã ã•ã„<span class="required">å¿…é ˆ</span></div>
        <div style="text-align: center; font-size: 0.85em; color: #888; margin-bottom: 15px;">
            ã”å¸Œæœ›ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã—ã¦ãã ã•ã„<br>ï¼ˆè¤‡æ•°é¸æŠå¯èƒ½ã§ã™ï¼‰
        </div>

        <button class="category-toggle" onclick="toggleCategory('cat-lymph')">
            <span>ãƒªãƒ³ãƒ‘ã‚±ã‚¢ <span class="selection-badge">é¸æŠä¸­</span></span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div id="cat-lymph" class="category-content">
            <div class="sub-label">ğŸ”¹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">æ¥µä¸Šå²©ç›¤ãƒªãƒ³ãƒ‘ã‚±ã‚¢ï¼ˆ130åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">æ¥µä¸Šå²©ç›¤ãƒªãƒ³ãƒ‘ã‚±ã‚¢ï¼ˆ100åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">æ¥µä¸Šå²©ç›¤ãƒªãƒ³ãƒ‘ã‚±ã‚¢ï¼ˆ70åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">å…¨èº«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚±ã‚¢ã‚³ãƒ¼ã‚¹ï¼ˆ160åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è‡ªç”±ã«ã‚»ãƒ¬ã‚¯ãƒˆã‚³ãƒ¼ã‚¹ï¼ˆ120åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">æ¸©æ´»å¼•ãç· ã‚ãƒœãƒ‡ã‚£ãƒ¼ã‚³ãƒ¼ã‚¹ï¼ˆ120åˆ†ï¼‰</button>
            </div>
            <div class="sub-label">ğŸ”¸ ã‚ªãƒ—ã‚·ãƒ§ãƒ³é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ã‚ˆã‚‚ãè’¸ã—ï¼ˆ40åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ20åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ60åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è¶³ãƒ„ãƒœï¼ˆ15åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ•ãƒƒãƒˆãƒªãƒ•ãƒ¬ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">å²©ç›¤æµ´ï¼†ãƒ›ãƒƒãƒˆã‚¹ãƒˆãƒ¼ãƒ³ï¼ˆ30åˆ†ï¼‰</button>
            </div>
        </div>

        <button class="category-toggle" onclick="toggleCategory('cat-head')">
            <span>ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ <span class="selection-badge">é¸æŠä¸­</span></span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div id="cat-head" class="category-content">
            <div class="sub-label">ğŸ”¹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ50åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ˜ãƒƒãƒ‰ï¼†ã‚‚ã¿ã»ãã—ã‚³ãƒ¼ã‚¹ï¼ˆ110åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è‡ªç”±ã«ã‚»ãƒ¬ã‚¯ãƒˆã‚³ãƒ¼ã‚¹ï¼ˆ120åˆ†ï¼‰</button>
            </div>
            <div class="sub-label">ğŸ”¸ ã‚ªãƒ—ã‚·ãƒ§ãƒ³é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ã‚ˆã‚‚ãè’¸ã—ï¼ˆ40åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">å²©ç›¤æµ´ï¼†ãƒ›ãƒƒãƒˆã‚¹ãƒˆãƒ¼ãƒ³ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è¶³ãƒ„ãƒœï¼ˆ15åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ•ãƒƒãƒˆãƒªãƒ•ãƒ¬ï¼ˆ30åˆ†ï¼‰</button>
            </div>
        </div>

        <button class="category-toggle" onclick="toggleCategory('cat-yomogi')">
            <span>ã‚ˆã‚‚ãè’¸ã— <span class="selection-badge">é¸æŠä¸­</span></span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div id="cat-yomogi" class="category-content">
            <div class="sub-label">ğŸ”¹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ã‚ˆã‚‚ãè’¸ã—ï¼ˆ40åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">å…¨èº«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚±ã‚¢ã‚³ãƒ¼ã‚¹ï¼ˆ160åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">æ¸©æ´»å¼•ãç· ã‚ãƒœãƒ‡ã‚£ãƒ¼ã‚³ãƒ¼ã‚¹ï¼ˆ120åˆ†ï¼‰</button>
            </div>
            <div class="sub-label">ğŸ”¸ ã‚ªãƒ—ã‚·ãƒ§ãƒ³é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ20åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ60åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è¶³ãƒ„ãƒœï¼ˆ15åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ•ãƒƒãƒˆãƒªãƒ•ãƒ¬ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ç‚­é…¸è¶³æ¹¯ï¼†è„šãƒªãƒ³ãƒ‘ï¼ˆ50åˆ†ï¼‰</button>
            </div>
        </div>

        <button class="category-toggle" onclick="toggleCategory('cat-mens')">
            <span>ãƒ¡ãƒ³ã‚ºãƒ¡ãƒ‹ãƒ¥ãƒ¼ <span class="selection-badge">é¸æŠä¸­</span></span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div id="cat-mens" class="category-content">
            <div class="sub-label">ğŸ”¹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ãƒ¡ãƒ³ã‚ºã‚³ãƒ¼ã‚¹ï¼ˆ120åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ˜ãƒƒãƒ‰ï¼†ã‚‚ã¿ã»ãã—ã‚³ãƒ¼ã‚¹ï¼ˆ110åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è‡ªç”±ã«ã‚»ãƒ¬ã‚¯ãƒˆã‚³ãƒ¼ã‚¹ï¼ˆ120åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">æ¸©æ´»ã‚‚ã¿ã»ãã—ã‚³ãƒ¼ã‚¹</button>
                <button type="button" onclick="toggleSelection(this)">ã‚ˆã‚‚ãè’¸ã—ï¼ˆ40åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ50åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ç‚­é…¸è¶³æ¹¯ï¼†è„šãƒªãƒ³ãƒ‘ï¼ˆ90åˆ†ï¼‰</button>
            </div>
            <div class="sub-label">ğŸ”¸ ã‚ªãƒ—ã‚·ãƒ§ãƒ³é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒ‰ãƒ©ã‚¤ãƒ˜ãƒƒãƒ‰ã‚¹ãƒ‘ï¼ˆ20åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ60åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚‚ã¿ã»ãã—ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ã‚ˆã‚‚ãè’¸ã—ï¼ˆ40åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è„šãƒªãƒ³ãƒ‘ï¼ˆ30åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">è¶³ãƒ„ãƒœï¼ˆ15åˆ†ï¼‰</button>
            </div>
        </div>

        <button class="category-toggle" onclick="toggleCategory('cat-pair')">
            <span>ãƒšã‚¢ã‚³ãƒ¼ã‚¹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ <span class="selection-badge">é¸æŠä¸­</span></span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div id="cat-pair" class="category-content">
            <div class="sub-label">ğŸ”¹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®</div>
            <div class="menu-buttons">
                <button type="button" onclick="toggleSelection(this)">ã‚ˆã‚‚ãè’¸ã—ï¼ˆ40åˆ†ï¼‰</button>
                <button type="button" onclick="toggleSelection(this)">ãƒšã‚¢ã‚³ãƒ¼ã‚¹ï¼ˆ100åˆ†ï¼‰</button>
            </div>
        </div>

        <div class="labelkibounitizi" id="kibou1">å¸Œæœ›æ—¥æ™‚<span class="required">å¿…é ˆ</span></div>
        <div class="datetime-wrapper">
            <span class="placeholder"><i class="far fa-calendar-alt"></i> ã‚¿ãƒƒãƒ—ã—ã¦æ—¥æ™‚ã‚’é¸æŠ</span>
            <div class="dt-grid">
                <select id="date1_day" class="datetime-input" onchange="updateDisplayInfo()"></select>
                <select id="date1_time" class="datetime-input" onchange="updateDisplayInfo()">
                    <option value="" disabled selected>æ™‚é–“å¸¯</option>
                    <option value="åˆå‰">åˆå‰</option>
                    <option value="åˆå¾Œ">åˆå¾Œ</option>
                </select>
            </div>
        </div>

        <div class="labelkibounitizi" id="kibou2">ç¬¬äºŒå¸Œæœ›æ—¥æ™‚<span class="required">å¿…é ˆ</span></div>
        <div class="datetime-wrapper">
            <span class="placeholder"><i class="far fa-calendar-alt"></i> ã‚¿ãƒƒãƒ—ã—ã¦æ—¥æ™‚ã‚’é¸æŠ</span>
            <div class="dt-grid">
                <select id="date2_day" class="datetime-input" onchange="updateDisplayInfo()"></select>
                <select id="date2_time" class="datetime-input" onchange="updateDisplayInfo()">
                    <option value="" disabled selected>æ™‚é–“å¸¯</option>
                    <option value="åˆå‰">åˆå‰</option>
                    <option value="åˆå¾Œ">åˆå¾Œ</option>
                </select>
            </div>
        </div>

        <div class="labelkibounitizi" id="kibou3">ç¬¬ä¸‰å¸Œæœ›æ—¥æ™‚<span class="required">å¿…é ˆ</span></div>
        <div class="datetime-wrapper">
            <span class="placeholder"><i class="far fa-calendar-alt"></i> ã‚¿ãƒƒãƒ—ã—ã¦æ—¥æ™‚ã‚’é¸æŠ</span>
            <div class="dt-grid">
                <select id="date3_day" class="datetime-input" onchange="updateDisplayInfo()"></select>
                <select id="date3_time" class="datetime-input" onchange="updateDisplayInfo()">
                    <option value="" disabled selected>æ™‚é–“å¸¯</option>
                    <option value="åˆå‰">åˆå‰</option>
                    <option value="åˆå¾Œ">åˆå¾Œ</option>
                </select>
            </div>
        </div>

        <div class="labelmessezi">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸<br><span style="font-size:0.8em; font-weight:normal;">ï¼ˆè³ªå•ç­‰ãŠæ°—è»½ã«ã”è¨˜å…¥ãã ã•ã„ï¼‰</span></div>
        <textarea id="message" rows="4" placeholder="ä¾‹ï¼šé§è»Šå ´ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ" oninput="updateDisplayInfo()"></textarea>

        <div class="labeltyuuou">ã”äºˆç´„å†…å®¹ç¢ºèª</div>
        <div id="displayInfo">
        </div>

        <button id="btn-submit" class="submit-button" onclick="submitForm()">äºˆç´„ã‚’è¡Œã†</button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        // LIFFåˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function () {
            liff.init({
                liffId: '2008936264-UjxuOpzF' 
            }).then(() => {
                console.log('LIFF OK');
            }).catch((err) => {
                console.log('LIFF Error', err);
            });

            // æ—¥ä»˜é¸æŠè‚¢ã®ç”Ÿæˆ
            buildDateOptions('date1_day');
            buildDateOptions('date2_day');
            buildDateOptions('date3_day');
            
            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å¾©å…ƒ
            const savedName = localStorage.getItem('name');
            const savedPhone = localStorage.getItem('phone');
            const savedVisit = localStorage.getItem('visitStatus');

            if (savedName) document.getElementById('name').value = savedName;
            if (savedPhone) document.getElementById('phone').value = savedPhone;

            // æ¥åº—å›æ•°ã®å¾©å…ƒãƒ­ã‚¸ãƒƒã‚¯
            if (savedVisit) {
                visitStatus = savedVisit; 
                const visitBtns = document.querySelectorAll('.visit-buttons button');
                visitBtns.forEach(btn => {
                    if (btn.textContent === savedVisit) {
                        btn.classList.add('active');
                    }
                });
            }

            // åˆå›è¡¨ç¤ºæ›´æ–°
            updateDisplayInfo();
        });

        // å…¥åŠ›å†…å®¹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
        function saveInput(id) {
            const value = document.getElementById(id).value;
            localStorage.setItem(id, value);
        }

        // ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®é–‹é–‰åˆ¶å¾¡
        function toggleCategory(id) {
            const content = document.getElementById(id);
            const button = document.querySelector(`button[onclick="toggleCategory('${id}')"]`);
            const icon = button.querySelector('i');

            if (content.style.display === "block") {
                content.style.display = "none";
                button.classList.remove("active-accordion");
                icon.className = "fas fa-chevron-down";
            } else {
                content.style.display = "block";
                button.classList.add("active-accordion");
                icon.className = "fas fa-chevron-up";
            }
        }

        // æ—¥ä»˜ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ—¥æ›œæ—¥ã‚’é™¤å¤–ï¼‰
        function buildDateOptions(elementId) {
            const select = document.getElementById(elementId);
            select.innerHTML = '<option value="" disabled selected>æ—¥ä»˜ã‚’é¸æŠ</option>';
            const today = new Date();
            const jpWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];

            for (let i = 1; i <= 60; i++) { // å‘ã“ã†60æ—¥åˆ†
                const d = new Date(today);
                d.setDate(today.getDate() + i);
                
                const wd = d.getDay();
                if (wd === 0) continue; // æ—¥æ›œå®šä¼‘

                const y = d.getFullYear();
                const m = ('0' + (d.getMonth() + 1)).slice(-2);
                const day = ('0' + d.getDate()).slice(-2);
                const val = `${y}-${m}-${day}`;
                const txt = `${m}/${day}ï¼ˆ${jpWeek[wd]}ï¼‰`;

                const opt = document.createElement('option');
                opt.value = val;
                opt.textContent = txt;
                select.appendChild(opt);
            }
        }

        // æ¥åº—å›æ•°é¸æŠ
        let visitStatus = '';
        function selectVisit(btn) {
            const siblings = btn.parentNode.querySelectorAll('button');
            siblings.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            visitStatus = btn.textContent;
            
            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            localStorage.setItem('visitStatus', visitStatus);

            updateDisplayInfo();
        }

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒˆã‚°ãƒ«é¸æŠ
        function toggleSelection(btn) {
            btn.classList.toggle('active');
            checkCategorySelection(btn);
            updateDisplayInfo();
        }

        // ã‚«ãƒ†ã‚´ãƒªãƒ¼å†…ã®é¸æŠçŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€è¦ªãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰ãˆã‚‹é–¢æ•°
        function checkCategorySelection(btn) {
            const contentDiv = btn.closest('.category-content');
            if (!contentDiv) return;

            const categoryId = contentDiv.id; 
            const toggleBtn = document.querySelector(`button[onclick="toggleCategory('${categoryId}')"]`);
            const hasActive = contentDiv.querySelectorAll('.menu-buttons button.active').length > 0;

            if (hasActive) {
                toggleBtn.classList.add('has-selection');
            } else {
                toggleBtn.classList.remove('has-selection');
            }
        }

        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨
        function scrollToElement(id) {
            const el = document.getElementById(id);
            if(el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // è¡¨ç¤ºå†…å®¹ã®æ›´æ–°
        function updateDisplayInfo() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            
            const selectedButtons = document.querySelectorAll('.menu-buttons button.active');
            let menuList = [];
            let totalTime = 0;

            selectedButtons.forEach(btn => {
                const text = btn.textContent;
                menuList.push(text);
                
                const match = text.match(/(\d+)åˆ†/);
                if (match) {
                    totalTime += parseInt(match[1], 10);
                }
            });

            let timeStr = "";
            if (totalTime > 0) {
                const h = Math.floor(totalTime / 60);
                const m = totalTime % 60;
                timeStr = h > 0 ? `${h}æ™‚é–“${m}åˆ†` : `${m}åˆ†`;
            }

            const d1 = getDateStr('date1');
            const d2 = getDateStr('date2');
            const d3 = getDateStr('date3');

            let html = '';

            // ãŠåå‰ãƒ»é›»è©±
            html += `<div class="info-row"><div class="info-label">ã€ãŠå®¢æ§˜æƒ…å ±ã€‘</div>`;
            html += `ãŠåå‰ï¼š${name || '<span style="color:#ccc">æœªå…¥åŠ›</span>'}<br>`;
            html += `é›»è©±ç•ªå·ï¼š${phone || '<span style="color:#ccc">æœªå…¥åŠ›</span>'}`;
            html += `<button class="edit-button" onclick="scrollToElement('lbl_name')">ä¿®æ­£</button></div>`;

            // æ¥åº—å›æ•°
            html += `<div class="info-row"><div class="info-label">ã€æ¥åº—å›æ•°ã€‘</div>`;
            html += `${visitStatus || '<span style="color:#d97d7d">æœªé¸æŠ</span>'}`;
            html += `<button class="edit-button" onclick="scrollToElement('lbl_visit')">ä¿®æ­£</button></div>`;

            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼
            html += `<div class="info-row"><div class="info-label">ã€é¸æŠãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€‘</div>`;
            if (menuList.length > 0) {
                html += `<ul style="margin:5px 0 5px 20px; padding:0; color:#555;">`;
                menuList.forEach(m => html += `<li>${m}</li>`);
                html += `</ul>`;
                if(timeStr) {
                    html += `<strong>ç›®å®‰æ‰€è¦æ™‚é–“ï¼š${timeStr}</strong>`;
                }
            } else {
                html += `<span style="color:#d97d7d">æœªé¸æŠ</span>`;
            }
            html += `<button class="edit-button" onclick="scrollToElement('lbl_menu')">ä¿®æ­£</button></div>`;

            // å¸Œæœ›æ—¥æ™‚
            html += `<div class="info-row"><div class="info-label">ã€å¸Œæœ›æ—¥æ™‚ã€‘</div>`;
            html += `ç¬¬ä¸€ï¼š${d1 || '<span style="color:#d97d7d">æœªé¸æŠ</span>'}<br>`;
            html += `ç¬¬äºŒï¼š${d2 || '<span style="color:#ccc">æœªé¸æŠ</span>'}<br>`;
            html += `ç¬¬ä¸‰ï¼š${d3 || '<span style="color:#ccc">æœªé¸æŠ</span>'}`;
            html += `<button class="edit-button" onclick="scrollToElement('kibou1')">ä¿®æ­£</button></div>`;

            document.getElementById('displayInfo').innerHTML = html;
        }

        function getDateStr(baseId) {
            const day = document.getElementById(baseId + '_day').value;
            const time = document.getElementById(baseId + '_time').value;
            if (!day || !time) return '';
            const dateParts = day.split('-');
            return `${dateParts[1]}/${dateParts[2]} ${time}`;
        }

        // é€ä¿¡å‡¦ç†ï¼ˆé€£æ‰“é˜²æ­¢æ©Ÿèƒ½ä»˜ãï¼‰
        function submitForm() {
            const submitBtn = document.getElementById('btn-submit');

            // 1. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å‰ã«ãƒœã‚¿ãƒ³ãŒæ—¢ã«æŠ¼ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ï¼ˆå¿µã®ãŸã‚ï¼‰
            if (submitBtn.disabled) return;

            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const menuBtns = document.querySelectorAll('.menu-buttons button.active');
            const d1_day = document.getElementById('date1_day').value;
            const d1_time = document.getElementById('date1_time').value;
            const message = document.getElementById('message').value;

            // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            if (!name) { alert('ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
            if (!phone) { alert('é›»è©±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
            if (!visitStatus) { alert('æ¥åº—å›æ•°ã‚’é¸æŠã—ã¦ãã ã•ã„'); return; }
            if (menuBtns.length === 0) { alert('ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’1ã¤ä»¥ä¸Šé¸æŠã—ã¦ãã ã•ã„'); return; }
            if (!d1_day || !d1_time) { alert('ç¬¬ä¸€å¸Œæœ›æ—¥æ™‚ã¯å¿…é ˆã§ã™'); return; }

            // 2. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é€šéå¾Œã€ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›´
            submitBtn.disabled = true;
            submitBtn.textContent = 'é€ä¿¡ä¸­...';

            // ãƒ‡ãƒ¼ã‚¿ä½œæˆ
            let menuText = "";
            menuBtns.forEach(btn => {
                menuText += `ãƒ»${btn.textContent}\n`;
            });

            const d1 = d1_day ? `${d1_day} ${d1_time}` : "æŒ‡å®šãªã—";
            const d2 = document.getElementById('date2_day').value ? `${document.getElementById('date2_day').value} ${document.getElementById('date2_time').value}` : "ãªã—";
            const d3 = document.getElementById('date3_day').value ? `${document.getElementById('date3_day').value} ${document.getElementById('date3_time').value}` : "ãªã—";

            const sendText = `ã€äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ ã€‘\n\n`
                + `[ãŠåå‰]\n${name}\n\n`
                + `[é›»è©±ç•ªå·]\n${phone}\n\n`
                + `[æ¥åº—å›æ•°]\n${visitStatus}\n\n`
                + `[å¸Œæœ›ãƒ¡ãƒ‹ãƒ¥ãƒ¼]\n${menuText}\n`
                + `[å¸Œæœ›æ—¥æ™‚]\nç¬¬ä¸€ï¼š${d1}\nç¬¬äºŒï¼š${d2}\nç¬¬ä¸‰ï¼š${d3}\n\n`
                + `[ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]\n${message}`;

            if (!liff.isInClient()) {
                alert('LINEã‚¢ãƒ—ãƒªå†…ã§é–‹ã„ã¦ãã ã•ã„ã€‚\n\né€ä¿¡å†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:\n' + sendText);
                // ãƒ†ã‚¹ãƒˆç”¨ï¼šPCãªã©LINEå¤–ãªã‚‰ãƒœã‚¿ãƒ³ã‚’æˆ»ã™
                submitBtn.disabled = false;
                submitBtn.textContent = 'äºˆç´„ã‚’è¡Œã†';
            } else {
                liff.sendMessages([{
                    type: 'text',
                    text: sendText
                }]).then(() => {
                    liff.closeWindow();
                }).catch((err) => {
                    alert('é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n' + err);
                    // ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸå ´åˆã¯å†é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ãƒœã‚¿ãƒ³ã‚’å¾©æ´»ã•ã›ã‚‹
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'äºˆç´„ã‚’è¡Œã†';
                });
            }
        }
    </script>
</body>

</html>
